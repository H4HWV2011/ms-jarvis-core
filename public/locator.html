Paste THIS ENTIRE FILE

<!DOCTYPE html><html> <head> <title>Ms. Jarvis Locator</title> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <style> /* Ensure full-height layout to prevent gray/blank maps */ html, body { height: 100%; margin: 0; padding: 0; } #app { height: 100%; display: flex; flex-direction: column; } header { padding: 8px 12px; border-bottom: 1px solid #eee; } .controls { padding: 8px 12px; display: grid; gap: 8px; } main { flex: 1 1 auto; min-height: 0; display: flex; flex-direction: column; } .map-host { flex: 1 1 auto; min-height: 0; } gmpx-place-autocomplete-element { max-width: 720px; width: 100%; } gmpx-store-locator { width: 100%; height: 100%; --gmpx-color-surface: #fff; --gmpx-color-on-surface: #212121; --gmpx-color-primary: #1967d2; } </style>
text
<script>
  // Configuration with your API key, Map ID, and Style ID
  const CONFIGURATION = {
    locations: [],
    mapOptions: {
      center: { lat: 38.5976, lng: -80.4549 }, // WV center
      zoom: 8,
      zoomControl: true,
      mapId: "ac6f916d09396325f229b63a",  // Your Map ID
      styleId: "a20d721364b377103883781e" // Your Style ID
    },
    mapsApiKey: "AIzaSyD2pi7G8ieuevRRJUSey_Rmpev7aWOdTx4", // Your API key
    capabilities: {
      input: true,
      autocomplete: true,
      directions: true,
      distanceMatrix: true,
      details: true,
      actions: false
    }
  };

  // Backend fetch for pins (tolerant of errors)
  async function fetchLocations() {
    try {
      const res = await fetch('/api/ai-locations');
      const json = await res.json();
      return Array.isArray(json.items) ? json.items : [];
    } catch {
      return [];
    }
  }
</script>

<script type="module">
  document.addEventListener('DOMContentLoaded', async () => {
    // Ensure components are registered
    await customElements.whenDefined('gmpx-store-locator');
    await customElements.whenDefined('gmpx-place-autocomplete-element');

    // Configure locator with live data
    const locator = document.querySelector('gmpx-store-locator');
    CONFIGURATION.locations = await fetchLocations();
    locator.configureFromQuickBuilder(CONFIGURATION);

    // New PlaceAutocompleteElement (2025+)
    const autocomplete = document.querySelector('gmpx-place-autocomplete-element');
    autocomplete.mapsApiKey = CONFIGURATION.mapsApiKey;
    autocomplete.placeholder = "Search West Virginia businesses or locations...";

    // Use gmp-select, fetch fields including 'location', then pan+zoom
    autocomplete.addEventListener('gmp-select', async (e) => {
      try {
        const prediction = e.detail?.placePrediction;
        if (!prediction) return;
        const place = prediction.toPlace();
        await place.fetchFields({ fields: ['displayName','formattedAddress','location'] });
        if (place.location && locator && typeof locator.setMapCenter === 'function') {
          locator.setMapCenter(place.location);
          if (typeof locator.setMapZoom === 'function') locator.setMapZoom(14);
        }
      } catch { /* no-op for smooth UX */ }
    });
  });
</script>
</head><body> <div id="app"> <header><strong>Ms. Jarvis Locator</strong></header>
text
  <div class="controls">
    <!-- Extended Component Library -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/@googlemaps/extended-component-library/0.6.11/index.min.js"></script>

    <!-- API Loader: same key as configuration -->
    <gmpx-api-loader
      key="AIzaSyD2pi7G8ieuevRRJUSey_Rmpev7aWOdTx4"
      solution-channel="GMP_QB_locatorplus_v11_cABCDE">
    </gmpx-api-loader>

    <!-- New (2025+) Autocomplete element -->
    <gmpx-place-autocomplete-element
      placeholder="Search WV places...">
    </gmpx-place-autocomplete-element>
  </div>

  <main>
    <div class="map-host">
      <!-- Store Locator with Map ID; styleId applied via mapOptions -->
      <gmpx-store-locator map-id="ac6f916d09396325f229b63a"></gmpx-store-locator>
    </div>
  </main>
</div>
</body> </html>
